# Report Bot

Node.js Telegram-бот для приёма заявок, управления линиями поддержки и маршрутизации жалоб по группам.

## Возможности

- регистрация пользователей по заявкам с уведомлением администраторов;
- привязка пользователей к линиям и группам логов;
- жалобы пользователей с выбором линии и отправкой текста в назначенный чат;
- выбор языка интерфейса (Русский/English) после подтверждения заявки;
- пользовательское меню настроек с быстрым доступом к смене языка и инструкции;
- обновлённый интерфейс с эмодзи и панель администратора (заявки, линии, пользователи, статистика, стоп-ворк);
- управление стоп-ворком с кастомным сообщением и сроком разблокировки.

## Требования

- Node.js 18+
- Бот Telegram с полученным токеном (BotFather)
- Список Telegram ID администраторов, которые будут управлять ботом

## Быстрый старт

1. Скопируйте файл `.env.example` в `.env` и заполните значения:
   ```env
   BOT_TOKEN=ваш_токен_бота
   ADMIN_IDS=123456789,987654321
   STOP_WORK_MESSAGE=Бот временно не принимает команды. Попробуйте позже.
   ```
2. Установите зависимости:
   ```bash
   npm install
   ```
3. Запустите бота:
   ```bash
   npm start
   ```

Бот создаст файл `data/db.json` для локального хранения данных (линии, пользователи, заявки, настройки).

## Основные сценарии

- Пользователь отправляет `/start` → создаётся заявка, администраторам приходит уведомление с кнопками «Отклонить» и «Подтвердить».
- После подтверждения администратор вводит ID линии → пользователь становится активным и выбирает язык интерфейса.
- Активный пользователь выбирает линию и описывает проблему → бот отправляет лог в группу, привязанную к линии.
- В разделе «⚙️ Настройки» пользователь может вернуться к выбору языка или открыть краткую инструкцию по отправке жалоб.

## Панель администратора

Вызовите команду `/admin` или `/start` от имени администратора — откроется меню с разделами:

- **Заявки** — список ожидающих заявок и быстрый отклик по каждой.
- **Линии** — создание линий, привязка/отвязка пользователей, назначение групп логов.
- **Пользователи** — бан, мут/размут, краткий список пользователей.
- **Статистика** — сводка по пользователям, линиям и заявкам.
- **Стоп ворк** — включение/выключение режима «закрыто до…».

При включении стоп-ворка отправьте сообщение в формате `YYYY-MM-DD HH:MM;Текст`, либо просто текст (если дата не нужна). Пользователи без прав администратора увидят указанное сообщение с эмодзи.

## Дополнительно

- Перед назначением группы для линии добавьте бота в нужный чат и убедитесь, что он может отправлять сообщения.
- Файл `data/db.json` можно резервировать/редактировать вручную при остановленном боте.
- Для расширения логики (например, добавления истории жалоб) удобно создавать отдельные модули рядом с `src/repository.js`.
